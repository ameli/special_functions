<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modified Bessel Function of the First Kind &mdash; special functions  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/toggleprompt.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/custom.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modified Bessel Function of the Second Kind" href="besselk.html" />
    <link rel="prev" title="Bessel Function of the Third Kind" href="besselh.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> special functions
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="list.html">List of Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/special_functions.html">Jupyter Notebook</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="besselj.html">Bessel Function, First Kind</a></li>
<li class="toctree-l1"><a class="reference internal" href="bessely.html">Bessel Function, Second Kind</a></li>
<li class="toctree-l1"><a class="reference internal" href="besselh.html">Bessel Function, Third Kind</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modified Bessel Function, First Kind</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#syntax">Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nu"><code class="docutils literal notranslate"><span class="pre">nu</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#z"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#n"><code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-in-cython-code">Using in Cython Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#real-function">Real Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complex-function">Complex Function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-in-python-code">Using in Python Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Real Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Complex Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#differences-with-scipy">Differences with Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#algorithm">Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#special-cases">Special Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#branch-cut">Branch-Cut</a></li>
<li class="toctree-l4"><a class="reference internal" href="#negative-nu">Negative <span class="math notranslate nohighlight">\(\nu\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#half-integer-nu">Half-Integer <span class="math notranslate nohighlight">\(\nu\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="besselk.html">Modified Bessel Function, Second Kind</a></li>
<li class="toctree-l1"><a class="reference internal" href="lngamma.html">Log Gamma Function</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_modules/modules.html">Package API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests.html">Running Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">special functions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Modified Bessel Function of the First Kind</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/besseli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="modified-bessel-function-of-the-first-kind">
<span id="besseli"></span><h1>Modified Bessel Function of the First Kind<a class="headerlink" href="#modified-bessel-function-of-the-first-kind" title="Permalink to this heading"></a></h1>
<p>This module computes the modified Bessel function of the first kind or its <span class="math notranslate nohighlight">\(n\)</span><sup>th</sup> derivative</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^n I_{\nu}(z)}{\partial z^n},\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> is the order of the derivative (<span class="math notranslate nohighlight">\(n = 0\)</span> indicates no derivative).</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu \in \mathbb{R}\)</span> is the order of the modified Bessel function.</p></li>
<li><p><span class="math notranslate nohighlight">\(z \in \mathbb{C}\)</span> is the input argument.</p></li>
</ul>
<section id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading"></a></h2>
<p>This function has the following syntaxes depending on whether it is used in Python or Cython, or the input argument <code class="docutils literal notranslate"><span class="pre">z</span></code> is complex or real.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 18%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Input Type</p></th>
<th class="head"><p>Function Signature</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Python</strong></p></td>
<td><p>Real or Complex</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">besseli(nu,</span> <span class="pre">z,</span> <span class="pre">n=0)</span></code></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><strong>Cython</strong></p></td>
<td><p>Real</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">besseli(double</span> <span class="pre">nu,</span> <span class="pre">double</span> <span class="pre">z,</span> <span class="pre">int</span> <span class="pre">n)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Complex</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span> <span class="pre">cbesseli(double</span> <span class="pre">nu,</span> <span class="pre">double</span> <span class="pre">complex</span> <span class="pre">z,</span> <span class="pre">int</span> <span class="pre">n)</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Input Arguments:</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nu">
<span class="sig-name descname"><span class="pre">nu</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">double</span></em><a class="headerlink" href="#nu" title="Permalink to this definition"></a></dt>
<dd><p>The parameter <span class="math notranslate nohighlight">\(\nu\)</span> of modified Bessel function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">double</span> <span class="pre">or</span> <span class="pre">double</span> <span class="pre">complex</span></em><a class="headerlink" href="#z" title="Permalink to this definition"></a></dt>
<dd><p>The input argument <span class="math notranslate nohighlight">\(z\)</span> of modified Bessel function.</p>
<ul class="simple">
<li><p>In <em>Python</em>, the function <code class="docutils literal notranslate"><span class="pre">besseli</span></code> accepts <code class="docutils literal notranslate"><span class="pre">double</span></code> and <code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code> types.</p></li>
<li><p>In <em>Cython</em>, the function <code class="docutils literal notranslate"><span class="pre">besseli</span></code> accepts <code class="docutils literal notranslate"><span class="pre">double</span></code> type.</p></li>
<li><p>In <em>Cython</em>, the function <code class="docutils literal notranslate"><span class="pre">cbesseli</span></code> accepts <code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code> type.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="n">
<span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#n" title="Permalink to this definition"></a></dt>
<dd><p>The order <span class="math notranslate nohighlight">\(n\)</span> of the derivative of modified Bessel function. Zero indicates no derivative.</p>
<ul class="simple">
<li><p>For the <em>Python</em> interface, the default value is <code class="docutils literal notranslate"><span class="pre">0</span></code> and this argument may not be provided.</p></li>
<li><p>For the <em>Cython</em> interfaces, no default value is defined and this argument should be provided.</p></li>
</ul>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="besselk.html#besselk"><span class="std std-ref">Modified Bessel function of the second kind</span></a>.</p>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<section id="using-in-cython-code">
<h3>Using in Cython Code<a class="headerlink" href="#using-in-cython-code" title="Permalink to this heading"></a></h3>
<p>The codes below should be used in a <code class="docutils literal notranslate"><span class="pre">.pyx</span></code> file and compiled with Cython.</p>
<p>As shown in the codes below, the python’s global lock interpreter, or <code class="docutils literal notranslate"><span class="pre">gil</span></code>, can be optionally released inside the scope of <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">nogil:</span></code> statement. This is especially useful in parallel OpenMP environments.</p>
<section id="real-function">
<h4>Real Function<a class="headerlink" href="#real-function" title="Permalink to this heading"></a></h4>
<p>This example shows the real function <code class="docutils literal notranslate"><span class="pre">besseli</span></code> to compute the modified Bessel function of the first kind for a real argument <code class="docutils literal notranslate"><span class="pre">z</span></code>. The output variables <code class="docutils literal notranslate"><span class="pre">d0i</span></code>, <code class="docutils literal notranslate"><span class="pre">d1i</span></code>, and <code class="docutils literal notranslate"><span class="pre">d2i</span></code> represent the values of modified Bessel function and its first and second derivatives, respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># cimport module in a *.pyx file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="n">cimport</span> <span class="n">besseli</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Declare typed variables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">d0i</span><span class="p">,</span> <span class="n">d1i</span><span class="p">,</span> <span class="n">d2i</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Releasing gil to secure maximum cythonic speedup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">nogil</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d0i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    <span class="c1"># no derivative</span>
<span class="gp">... </span>    <span class="n">d1i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">... </span>    <span class="n">d2i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</section>
<section id="complex-function">
<h4>Complex Function<a class="headerlink" href="#complex-function" title="Permalink to this heading"></a></h4>
<p>The example below is similar to the above, except, the <em>complex</em> function <code class="docutils literal notranslate"><span class="pre">cbesseli</span></code> with complex argument <code class="docutils literal notranslate"><span class="pre">z</span></code> is used. The output variables <code class="docutils literal notranslate"><span class="pre">d0i</span></code>, <code class="docutils literal notranslate"><span class="pre">d1i</span></code>, and <code class="docutils literal notranslate"><span class="pre">d2i</span></code> are also complex.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># cimport module in a *.pyx file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="n">cimport</span> <span class="n">cbesseli</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Declare typed variables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="nb">complex</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="nb">complex</span> <span class="n">d0i</span><span class="p">,</span> <span class="n">d1i</span><span class="p">,</span> <span class="n">d2i</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Releasing gil to secure maximum cythonic speedup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">nogil</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d0i</span> <span class="o">=</span> <span class="n">cbesseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    <span class="c1"># no derivative</span>
<span class="gp">... </span>    <span class="n">d1i</span> <span class="o">=</span> <span class="n">cbesseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">... </span>    <span class="n">d2i</span> <span class="o">=</span> <span class="n">cbesseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</section>
</section>
<section id="using-in-python-code">
<h3>Using in Python Code<a class="headerlink" href="#using-in-python-code" title="Permalink to this heading"></a></h3>
<p>The codes below should be used in a <code class="docutils literal notranslate"><span class="pre">.py</span></code> file and no compilation is required. The python’s global lock interpreter, or <code class="docutils literal notranslate"><span class="pre">gil</span></code>, cannot be released.</p>
<section id="id1">
<h4>Real Function<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>The example below uses the function <code class="docutils literal notranslate"><span class="pre">besseli</span></code> with the real argument <code class="docutils literal notranslate"><span class="pre">z</span></code> to compute the modified Bessel function of the first kind and its first and second derivatives.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># import module in a *.py file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="kn">import</span> <span class="n">besseli</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d0i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>       <span class="c1"># no derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Complex Function<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>To use a complex input argument <code class="docutils literal notranslate"><span class="pre">z</span></code> in the Python interface, the same function <code class="docutils literal notranslate"><span class="pre">besseli</span></code> as the previous example can be used. This is unlike the Cython interface in which <code class="docutils literal notranslate"><span class="pre">cbesseli</span></code> should be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># import module in a *.py file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="kn">import</span> <span class="n">besseli</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d0i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>       <span class="c1"># no derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2i</span> <span class="o">=</span> <span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="differences-with-scipy">
<h2>Differences with Scipy<a class="headerlink" href="#differences-with-scipy" title="Permalink to this heading"></a></h2>
<p>There are very few differences between numerical results of this package compared to scipy. In the real domain <span class="math notranslate nohighlight">\(z \in \mathbb{Z}\)</span>, it holds:</p>
<div class="math notranslate nohighlight">
\[I_{\nu}(0) = (-1)^{\lceil \nu \rceil} \infty, \qquad \nu &lt; 0 \quad \text{and} \quad \nu \notin \mathbb{Z},\]</div>
<p>where <span class="math notranslate nohighlight">\(\lceil \nu \rceil\)</span> is the ceil function.</p>
<p>The sign of infinity in the above is returned correctly with this package. However, scipy always returns <span class="math notranslate nohighlight">\(+\infty\)</span> incorrectly regardless of <span class="math notranslate nohighlight">\(\nu\)</span>. That is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This returns correct value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="kn">import</span> <span class="n">besseli</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besseli</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">-inf</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This returns incorrect value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">iv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span> <span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">inf</span>
</pre></div>
</div>
<p>However, in the complex domain <span class="math notranslate nohighlight">\(z \in \mathbb{C}\)</span> at <span class="math notranslate nohighlight">\(z = 0\)</span>, the answer to the above function value is <code class="docutils literal notranslate"><span class="pre">nan</span></code> and both this package and scipy return similar answers.</p>
<p>This issue also affects higher-order derivatives. For instance, in the real domain <span class="math notranslate nohighlight">\(z \in \mathbb{R}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\left. \frac{\partial^n I_{0}(z)}{\partial^n z} \right|_{z = 0} = \text{undefined}, \qquad n \geq 2, \quad \nu &lt; 0, \quad \text{and} \quad \nu \notin \mathbb{Z},\]</div>
<p>we have:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This returns correct value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="kn">import</span> <span class="n">besseli</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besseli</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">nan</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This returns incorrect value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">ivp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iv</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">inf</span>
</pre></div>
</div>
</section>
<section id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this heading"></a></h2>
<p>The test script of this module is located at <a class="reference external" href="https://github.com/ameli/special_functions/blob/main/tests/test_besseli.py"><code class="docutils literal notranslate"><span class="pre">tests/test_besseli.py</span></code></a>. The test compares the results of this module with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html"><code class="docutils literal notranslate"><span class="pre">scipy.special</span></code></a> package (functions <code class="docutils literal notranslate"><span class="pre">i0</span></code>, <code class="docutils literal notranslate"><span class="pre">i1</span></code>, <code class="docutils literal notranslate"><span class="pre">iv</span></code>, and <code class="docutils literal notranslate"><span class="pre">ivp</span></code>) for several combinations of input parameters with multiple values. Run the test by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">git clone https://github.com/ameli/special_functions.git</span>
<span class="prompt1"><span class="nb">cd</span> special_functions/tests</span>
<span class="prompt1">python test_besseli.py</span>
</pre></div></div></section>
<section id="algorithm">
<h2>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this heading"></a></h2>
<p>Depending on the values of the input parameters <span class="math notranslate nohighlight">\((\nu, z, n)\)</span>, one of the following three algorithms is employed.</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(z \in \mathbb{R}\)</span> (that is, <code class="docutils literal notranslate"><span class="pre">z</span></code> is of type <code class="docutils literal notranslate"><span class="pre">double</span></code>) and <span class="math notranslate nohighlight">\(\nu = 0\)</span> or <span class="math notranslate nohighlight">\(\nu = 1\)</span>, the computation is carried out by Cephes C library (see <a class="reference internal" href="../index.html#cephes-1989" id="id3"><span>[Cephes-1989]</span></a>), respectively using <code class="docutils literal notranslate"><span class="pre">i0</span></code> or <code class="docutils literal notranslate"><span class="pre">i1</span></code> functions in that library.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\nu + \frac{1}{2} \in \mathbb{Z}\)</span>, the modified Bessel function is computed using <a class="reference internal" href="#half-int-besseli"><span class="std std-ref">half-integer formulas</span></a> in terms of elementary functions.</p></li>
<li><p>For other cases, the computation is carried out by Amos Fortran library (see <a class="reference internal" href="../index.html#amos-1986" id="id4"><span>[Amos-1986]</span></a>) using <code class="docutils literal notranslate"><span class="pre">zbesi</span></code> subroutine in that library.</p></li>
</ul>
<section id="special-cases">
<h3>Special Cases<a class="headerlink" href="#special-cases" title="Permalink to this heading"></a></h3>
<p>In the special cases below, the computation is performed by taking advantage of some of the known formulas and properties of the modified Bessel functions.</p>
<section id="branch-cut">
<h4>Branch-Cut<a class="headerlink" href="#branch-cut" title="Permalink to this heading"></a></h4>
<ul>
<li><p>In the real domain where <span class="math notranslate nohighlight">\(z \in\mathbb{R}\)</span>, if <span class="math notranslate nohighlight">\(z &lt; 0\)</span> and <span class="math notranslate nohighlight">\(\nu \notin \mathbb{Z}\)</span>, the value of <code class="docutils literal notranslate"><span class="pre">NAN</span></code> is returned.</p></li>
<li><p>However, in the complex domain <span class="math notranslate nohighlight">\(z \in\mathbb{C}\)</span> and on the branch-cut of the function, <span class="math notranslate nohighlight">\(\Re(z) &lt; 0\)</span> and <span class="math notranslate nohighlight">\(\Im(z) = 0\)</span>, its <em>principal value</em> corresponding to the branch</p>
<div class="math notranslate nohighlight">
\[\mathrm{arg}(z) \in (-\pi, \pi]\]</div>
<p>is returned. This value may be finite, infinity or undefined depending on <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(z\)</span>.</p>
</li>
</ul>
</section>
<section id="negative-nu">
<h4>Negative <span class="math notranslate nohighlight">\(\nu\)</span><a class="headerlink" href="#negative-nu" title="Permalink to this heading"></a></h4>
<p>When <span class="math notranslate nohighlight">\(\nu &lt; 0\)</span> and for the two cases below, the modified Bessel function is related to the modified Bessel function of the positive parameter <span class="math notranslate nohighlight">\(-\nu\)</span>.</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(\nu \in \mathbb{Z}\)</span> (see <a class="reference internal" href="bessely.html#dlmf" id="id5"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.27#E1">10.27.1</a>):</p>
<div class="math notranslate nohighlight">
\[I_{\nu}(z) = I_{-\nu}(z)\]</div>
</li>
<li><p>If <span class="math notranslate nohighlight">\(\nu + \frac{1}{2} \in \mathbb{Z}\)</span> (see <a class="reference internal" href="bessely.html#dlmf" id="id7"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.2#E3">10.27.2</a>):</p>
<div class="math notranslate nohighlight">
\[I_{\nu}(z) = I_{-\nu}(z) - \frac{2}{\pi} \sin(\pi \nu) K_{-\nu}(z),\]</div>
<p>where <span class="math notranslate nohighlight">\(K_{\nu}(z)\)</span> is the <a class="reference internal" href="bessely.html#bessely"><span class="std std-ref">modified Bessel function of the second kind</span></a>.</p>
</li>
</ul>
</section>
<section id="derivatives">
<h4>Derivatives<a class="headerlink" href="#derivatives" title="Permalink to this heading"></a></h4>
<p>If <span class="math notranslate nohighlight">\(n &gt; 0\)</span>, the following relation for the derivative is applied (see <a class="reference internal" href="bessely.html#dlmf" id="id9"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.29#E5">10.29.5</a>):</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^n I_{\nu}(z)}{\partial z^n} = \frac{1}{2^n} \sum_{i = 0}^n \binom{n}{i} I_{\nu - n + 2i}(z).\]</div>
</section>
<section id="half-integer-nu">
<span id="half-int-besseli"></span><h4>Half-Integer <span class="math notranslate nohighlight">\(\nu\)</span><a class="headerlink" href="#half-integer-nu" title="Permalink to this heading"></a></h4>
<p>When <span class="math notranslate nohighlight">\(\nu\)</span> is half-integer, the modified Bessel function is computed in terms of elementary functions as follows.</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(z = 0\)</span>:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(\nu &gt; 0\)</span>, then <span class="math notranslate nohighlight">\(I_{\nu}(0) = 0\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\nu \leq 0\)</span>:</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(z \in \mathbb{R}\)</span>, then <span class="math notranslate nohighlight">\(I_{\nu}(0) = +\infty\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(z \in \mathbb{C}\)</span>, then <code class="docutils literal notranslate"><span class="pre">NAN</span></code> is returned.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>If <span class="math notranslate nohighlight">\(\nu = \pm \frac{1}{2}\)</span> (see <a class="reference internal" href="bessely.html#dlmf" id="id11"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.39#E1">10.39.1</a>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}I_{\frac{1}{2}}(z) = \sqrt{\frac{2}{\pi z}} \sinh(z), \\
I_{-\frac{1}{2}}(z) = \sqrt{\frac{2}{\pi z}} \cosh(z).\end{split}\]</div>
<p>Depending on <span class="math notranslate nohighlight">\(z\)</span>, the above relations are computed using the real or complex implementation of the elementary functions.</p>
</li>
<li><p>Higher-order half-integer parameter <span class="math notranslate nohighlight">\(\nu\)</span> is related to the above relation for <span class="math notranslate nohighlight">\(\nu = \pm \frac{1}{2}\)</span> using recursive formulas (see <a class="reference internal" href="bessely.html#dlmf" id="id13"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.6#E1">10.6.1</a>):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}I_{\nu}(z) = \frac{2 (\nu - 1)}{z} I_{\nu - 1}(z) + I_{\nu - 2}(z), \qquad \nu &gt; 0, \\
I_{\nu}(z) = \frac{2 (\nu + 1)}{z} I_{\nu + 1}(z) + I_{\nu + 2}(z), \qquad \nu &lt; 0.\end{split}\]</div>
</section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<dl class="citation">
<dt class="label" id="cephes-1989"><span class="brackets"><a class="fn-backref" href="#id3">Cephes-1989</a></span></dt>
<dd><p>Moshier, S. L. (1989). C language library with special functions for mathematical physics. Available at <a class="reference external" href="http://www.netlib.org/cephes">http://www.netlib.org/cephes</a>.</p>
</dd>
<dt class="label" id="amos-1986"><span class="brackets"><a class="fn-backref" href="#id4">Amos-1986</a></span></dt>
<dd><p>Amos, D. E. (1986). Algorithm 644: A portable package for Bessel functions of a complex argument and nonnegative order. ACM Trans. Math. Softw. 12, 3 (Sept. 1986), 265-273. DOI: <a class="reference external" href="https://doi.org/10.1145/7921.214331">https://doi.org/10.1145/7921.214331</a>. Available at <a class="reference external" href="http://netlib.org/amos/">http://netlib.org/amos/</a>.</p>
</dd>
<dt class="label" id="dlmf"><span class="brackets">DLMF</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id7">2</a>,<a href="#id9">3</a>,<a href="#id11">4</a>,<a href="#id13">5</a>)</span></dt>
<dd><p>Olver, F. W. J., Olde Daalhuis, A. B., Lozier, D. W., Schneider, B. I., Boisvert, R. F., Clark, C. W., Miller, B. R., Saunders, B. V., Cohl, H. S., and McClain, M. A., eds. NIST Digital Library of Mathematical Functions. <a class="reference external" href="http://dlmf.nist.gov/">http://dlmf.nist.gov/</a>, Release 1.1.0 of 2020-12-15.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="besselh.html" class="btn btn-neutral float-left" title="Bessel Function of the Third Kind" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="besselk.html" class="btn btn-neutral float-right" title="Modified Bessel Function of the Second Kind" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Siavash Ameli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>