

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Bessel Function of the Third Kind &mdash; special functions  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/toggleprompt.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modified Bessel Function of the First Kind" href="besseli.html" />
    <link rel="prev" title="Bessel Function of the Second Kind" href="bessely.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> special functions
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="list.html">List of Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Functions User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="besselj.html">Bessel Function, First Kind</a></li>
<li class="toctree-l1"><a class="reference internal" href="bessely.html">Bessel Function, Second Kind</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bessel Function, Third Kind</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-in-cython-code">Using in Cython Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#real-input">Real Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complex-input">Complex Input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-in-python-code">Using in Python Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Real Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Complex Input</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tests">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#algorithm">Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#special-cases">Special Cases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#negative-nu">Negative <span class="math notranslate nohighlight">\(\nu\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#half-integer-nu">Half-Integer <span class="math notranslate nohighlight">\(\nu\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="besseli.html">Modified Bessel Function, First Kind</a></li>
<li class="toctree-l1"><a class="reference internal" href="besselk.html">Modified Bessel Function, Second Kind</a></li>
<li class="toctree-l1"><a class="reference internal" href="lngamma.html">Log Gamma Function</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_modules/modules.html">Package API</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Running Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">special functions</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Bessel Function of the Third Kind</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/besselh.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bessel-function-of-the-third-kind">
<span id="besselh"></span><h1>Bessel Function of the Third Kind<a class="headerlink" href="#bessel-function-of-the-third-kind" title="Permalink to this headline">¶</a></h1>
<p>This module computes the Bessel function of the third kind (Hankel function) or its <span class="math notranslate nohighlight">\(n\)</span><sup>th</sup> derivative</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^n H^{(k)}_{\nu}(z)}{\partial z^n},\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> is the order of the derivative (<span class="math notranslate nohighlight">\(n = 0\)</span> indicates no derivative).</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> can be <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(2\)</span> and indicates the Hankel function of the first or second type, respectively.</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu \in \mathbb{R}\)</span> is the order of the Bessel function.</p></li>
<li><p><span class="math notranslate nohighlight">\(z \in \mathbb{C}\)</span> is the input argument.</p></li>
</ul>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>This function has the following syntaxes depending on whether it is used in Python or Cython, or the input argument <code class="docutils literal notranslate"><span class="pre">z</span></code> is complex or real.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 17%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Input Type</p></th>
<th class="head"><p>Function Signature</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Python</strong></p></td>
<td><p>Real or Complex</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">besselh(nu,</span> <span class="pre">k,</span> <span class="pre">z,</span> <span class="pre">n=0)</span></code></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><strong>Cython</strong></p></td>
<td><p>Real</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span> <span class="pre">besselh(double</span> <span class="pre">nu,</span> <span class="pre">int</span> <span class="pre">k,</span> <span class="pre">double</span> <span class="pre">z,</span> <span class="pre">int</span> <span class="pre">n)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Complex</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span> <span class="pre">cbesselh(double</span> <span class="pre">nu,</span> <span class="pre">int</span> <span class="pre">k,</span> <span class="pre">double</span> <span class="pre">complex</span> <span class="pre">z,</span> <span class="pre">int</span> <span class="pre">n)</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Input Arguments:</strong></p>
<dl class="py attribute">
<dt id="nu">
<code class="sig-name descname">nu</code><em class="property">: double</em><a class="headerlink" href="#nu" title="Permalink to this definition">¶</a></dt>
<dd><p>The parameter <span class="math notranslate nohighlight">\(\nu\)</span> of Bessel function.</p>
</dd></dl>

<dl class="py attribute">
<dt id="k">
<code class="sig-name descname">k</code><em class="property">: int</em><a class="headerlink" href="#k" title="Permalink to this definition">¶</a></dt>
<dd><p>It can be either <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code> and determines the Hankel function of the first or second kind, respectively.</p>
</dd></dl>

<dl class="py attribute">
<dt id="z">
<code class="sig-name descname">z</code><em class="property">: double or double complex</em><a class="headerlink" href="#z" title="Permalink to this definition">¶</a></dt>
<dd><p>The input argument <span class="math notranslate nohighlight">\(z\)</span> of Bessel function.</p>
<ul class="simple">
<li><p>In <em>Python</em>, the function <code class="docutils literal notranslate"><span class="pre">besselh</span></code> accepts <code class="docutils literal notranslate"><span class="pre">double</span></code> and <code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code> types.</p></li>
<li><p>In <em>Cython</em>, the function <code class="docutils literal notranslate"><span class="pre">besselh</span></code> accepts <code class="docutils literal notranslate"><span class="pre">double</span></code> type.</p></li>
<li><p>In <em>Cython</em>, the function <code class="docutils literal notranslate"><span class="pre">cbesselh</span></code> accepts <code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code> type.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt id="n">
<code class="sig-name descname">n</code><em class="property">: int</em><em class="property"> = 0</em><a class="headerlink" href="#n" title="Permalink to this definition">¶</a></dt>
<dd><p>The order <span class="math notranslate nohighlight">\(n\)</span> of the derivative of Bessel function. Zero indicates no derivative.</p>
<ul class="simple">
<li><p>For the <em>Python</em> interface, the default value is <code class="docutils literal notranslate"><span class="pre">0</span></code> and this argument may not be provided.</p></li>
<li><p>For the <em>Cython</em> interfaces, no default value is defined and this argument should be provided.</p></li>
</ul>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="besselj.html#besselj"><span class="std std-ref">Bessel function of the first kind</span></a>.</p></li>
<li><p><a class="reference internal" href="bessely.html#bessely"><span class="std std-ref">Bessel function of the second kind</span></a>.</p></li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-in-cython-code">
<h3>Using in Cython Code<a class="headerlink" href="#using-in-cython-code" title="Permalink to this headline">¶</a></h3>
<p>The codes below should be used in a <code class="docutils literal notranslate"><span class="pre">.pyx</span></code> file and compiled with Cython.</p>
<p>As shown in the codes below, the python’s global lock interpreter, or <code class="docutils literal notranslate"><span class="pre">gil</span></code>, can be optionally released inside the scope of <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">nogil:</span></code> statement. This is especially useful in parallel OpenMP environments.</p>
<div class="section" id="real-input">
<h4>Real Input<a class="headerlink" href="#real-input" title="Permalink to this headline">¶</a></h4>
<p>This example shows the real function <code class="docutils literal notranslate"><span class="pre">besselh</span></code> to compute the Bessel function of the third kind for a real argument <code class="docutils literal notranslate"><span class="pre">z</span></code>. The output variables <code class="docutils literal notranslate"><span class="pre">d0h</span></code>, <code class="docutils literal notranslate"><span class="pre">d1h</span></code>, and <code class="docutils literal notranslate"><span class="pre">d2h</span></code> are complex variables and represent the values of Bessel function and its first and second derivatives, respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># cimport module in a *.pyx file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="n">cimport</span> <span class="n">besselh</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Declare typed variables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="nb">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="nb">complex</span> <span class="n">d0h</span><span class="p">,</span> <span class="n">d1h</span><span class="p">,</span> <span class="n">d2h</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Releasing gil to secure maximum cythonic speedup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">nogil</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d0h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    <span class="c1"># no derivative</span>
<span class="gp">... </span>    <span class="n">d1h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">... </span>    <span class="n">d2h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</div>
<div class="section" id="complex-input">
<h4>Complex Input<a class="headerlink" href="#complex-input" title="Permalink to this headline">¶</a></h4>
<p>The example below is similar to the above, except, the <em>complex</em> function <code class="docutils literal notranslate"><span class="pre">cbesselh</span></code> with complex argument <code class="docutils literal notranslate"><span class="pre">z</span></code> is used. The output variables <code class="docutils literal notranslate"><span class="pre">d0h</span></code>, <code class="docutils literal notranslate"><span class="pre">d1h</span></code>, and <code class="docutils literal notranslate"><span class="pre">d2h</span></code> are complex.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># cimport module in a *.pyx file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="n">cimport</span> <span class="n">cbesselh</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Declare typed variables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="nb">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="nb">complex</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdef</span> <span class="n">double</span> <span class="nb">complex</span> <span class="n">d0h</span><span class="p">,</span> <span class="n">d1h</span><span class="p">,</span> <span class="n">d2h</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Releasing gil to secure maximum cythonic speedup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">nogil</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d0h</span> <span class="o">=</span> <span class="n">cbesselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    <span class="c1"># no derivative</span>
<span class="gp">... </span>    <span class="n">d1h</span> <span class="o">=</span> <span class="n">cbesselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">... </span>    <span class="n">d2h</span> <span class="o">=</span> <span class="n">cbesselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-in-python-code">
<h3>Using in Python Code<a class="headerlink" href="#using-in-python-code" title="Permalink to this headline">¶</a></h3>
<p>The codes below should be used in a <code class="docutils literal notranslate"><span class="pre">.py</span></code> file and no compilation is required. The python’s global lock interpreter, or <code class="docutils literal notranslate"><span class="pre">gil</span></code>, cannot be released.</p>
<div class="section" id="id1">
<h4>Real Input<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>The example below uses the function <code class="docutils literal notranslate"><span class="pre">besselh</span></code> with the real argument <code class="docutils literal notranslate"><span class="pre">z</span></code> to compute the Bessel function of the third kind and its first and second derivatives.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># import module in a *.py file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="kn">import</span> <span class="n">besselh</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d0h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>       <span class="c1"># no derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>Complex Input<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>To use a complex input argument <code class="docutils literal notranslate"><span class="pre">z</span></code> in the Python interface, the same function <code class="docutils literal notranslate"><span class="pre">besselh</span></code> as the previous example can be used. This is unlike the Cython interface in which <code class="docutils literal notranslate"><span class="pre">cbesselh</span></code> should be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># import module in a *.py file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">special_functions</span> <span class="kn">import</span> <span class="n">besselh</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">nu</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d0h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>       <span class="c1"># no derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># 1st derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2h</span> <span class="o">=</span> <span class="n">besselh</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 2nd derivative</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2>
<p>The test script of this module is located at <a class="reference external" href="https://github.com/ameli/special_functions/blob/main/tests/test_besselh.py"><code class="docutils literal notranslate"><span class="pre">tests/test_besselh.py</span></code></a>. The test compares the results of this module with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html"><code class="docutils literal notranslate"><span class="pre">scipy.special</span></code></a> package (functions <code class="docutils literal notranslate"><span class="pre">j0</span></code>, <code class="docutils literal notranslate"><span class="pre">j1</span></code>, <code class="docutils literal notranslate"><span class="pre">jn</span></code>, <code class="docutils literal notranslate"><span class="pre">jv</span></code>, and <code class="docutils literal notranslate"><span class="pre">jvp</span></code>) for several combinations of input parameters with multiple values. Run the test by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ameli</span><span class="o">/</span><span class="n">special_functions</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">special_functions</span><span class="o">/</span><span class="n">tests</span>
<span class="n">python</span> <span class="n">test_besselh</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="algorithm">
<h2>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this headline">¶</a></h2>
<p>Depending on the values of the input parameters <span class="math notranslate nohighlight">\((\nu, z, n)\)</span>, one of the following two algorithms is employed.</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(\nu + \frac{1}{2} \in \mathbb{Z}\)</span>, the Bessel function is computed using <a class="reference internal" href="#half-int-besselh"><span class="std std-ref">half-integer formulas</span></a> in terms of elementary functions.</p></li>
<li><p>For other cases, the computation is carried out by Amos Fortran library (see <a class="reference internal" href="index.html#amos-1986" id="id3"><span>[Amos-1986]</span></a>) using <code class="docutils literal notranslate"><span class="pre">zbesh</span></code> subroutine in that library.</p></li>
</ul>
<div class="section" id="special-cases">
<h3>Special Cases<a class="headerlink" href="#special-cases" title="Permalink to this headline">¶</a></h3>
<p>In the special cases below, the computation is performed by taking advantage of some of the known formulas and properties of the Bessel functions.</p>
<div class="section" id="negative-nu">
<h4>Negative <span class="math notranslate nohighlight">\(\nu\)</span><a class="headerlink" href="#negative-nu" title="Permalink to this headline">¶</a></h4>
<p>When <span class="math notranslate nohighlight">\(\nu &lt; 0\)</span> and for the two cases below, the Bessel function is related to the Bessel function of the positive parameter <span class="math notranslate nohighlight">\(-\nu\)</span>.</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(\nu \in \mathbb{Z}\)</span> (see <a class="reference internal" href="bessely.html#dlmf" id="id4"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.4#E1">10.4.1</a>):</p>
<div class="math notranslate nohighlight">
\[H^{(k)}_{\nu}(z) = (-1)^{\nu} H^{(k)}_{-\nu}(z),\]</div>
<p>where <span class="math notranslate nohighlight">\(k = 1, 2\)</span>.</p>
</li>
<li><p>If <span class="math notranslate nohighlight">\(\nu + \frac{1}{2} \in \mathbb{Z}\)</span> (see <a class="reference internal" href="bessely.html#dlmf" id="id6"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.2#E3">10.2.3</a>):</p>
<div class="math notranslate nohighlight">
\[H^{(k)}_{\nu}(z) = \left( \cos(\pi \nu) - i \alpha(k) \sin(\pi \nu) \right) H^{(k)}_{-\nu}(z),\]</div>
<p>where <span class="math notranslate nohighlight">\(k = 1, 2\)</span>, <span class="math notranslate nohighlight">\(\alpha(1) = 1\)</span>, and <span class="math notranslate nohighlight">\(\alpha(2) = -1\)</span>.</p>
</li>
</ul>
</div>
<div class="section" id="derivatives">
<h4>Derivatives<a class="headerlink" href="#derivatives" title="Permalink to this headline">¶</a></h4>
<p>If <span class="math notranslate nohighlight">\(n &gt; 0\)</span>, the following relation for the derivative is applied (see <a class="reference internal" href="bessely.html#dlmf" id="id8"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.6#E7">10.6.7</a>):</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^n H^{(k)}_{\nu}(z)}{\partial z^n} = \frac{1}{2^n} \sum_{i = 0}^n (-1)^i \binom{n}{i} H^{(k)}_{\nu - n + 2i}(z),\]</div>
<p>where <span class="math notranslate nohighlight">\(k = 1, 2\)</span>.</p>
</div>
<div class="section" id="half-integer-nu">
<span id="half-int-besselh"></span><h4>Half-Integer <span class="math notranslate nohighlight">\(\nu\)</span><a class="headerlink" href="#half-integer-nu" title="Permalink to this headline">¶</a></h4>
<p>When <span class="math notranslate nohighlight">\(\nu\)</span> is half-integer, the Bessel function is computed in terms of elementary functions as follows.</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(z = 0\)</span>, then <code class="docutils literal notranslate"><span class="pre">NAN</span></code> is returned.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(z &lt; 0\)</span> and <span class="math notranslate nohighlight">\(z \in \mathbb{R}\)</span>, then <code class="docutils literal notranslate"><span class="pre">NAN</span></code> is returned.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\nu = \pm \frac{1}{2}\)</span> (see <a class="reference internal" href="bessely.html#dlmf" id="id10"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.16#E1">10.16.1</a>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}H^{(k)}_{\frac{1}{2}}(z) = \sqrt{\frac{2}{\pi z}} \left( \sin(z) - i \alpha(k) \cos(z) \right), \\
H^{(k)}_{-\frac{1}{2}}(z) = \sqrt{\frac{2}{\pi z}} \left( \cos(z) + i \alpha(k) \sin(z) \right),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(k = 1, 2\)</span> and <span class="math notranslate nohighlight">\(\alpha(1) = 1\)</span> and <span class="math notranslate nohighlight">\(\alpha(2) = -1\)</span>. Depending on <span class="math notranslate nohighlight">\(z\)</span>, the above relations are computed using the real or complex implementation of the elementary functions.</p>
</li>
<li><p>Higher-order half-integer parameter <span class="math notranslate nohighlight">\(\nu\)</span> is related to the above relation for <span class="math notranslate nohighlight">\(\nu = \pm \frac{1}{2}\)</span> using recursive formulas (see <a class="reference internal" href="bessely.html#dlmf" id="id12"><span>[DLMF]</span></a> Eq. <a class="reference external" href="https://dlmf.nist.gov/10.6#E1">10.6.1</a>):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}H^{(k)}_{\nu}(z) = \frac{2 (\nu - 1)}{z} H^{(k)}_{\nu - 1}(z) - H^{(k)}_{\nu - 2}(z), \qquad \nu &gt; 0, \\
H^{(k)}_{\nu}(z) = \frac{2 (\nu + 1)}{z} H^{(k)}_{\nu + 1}(z) - H^{(k)}_{\nu + 2}(z), \qquad \nu &lt; 0,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(k = 1, 2\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="cephes-1989"><span class="brackets">Cephes-1989</span></dt>
<dd><p>Moshier, S. L. (1989). C language library with special functions for mathematical physics. Available at <a class="reference external" href="http://www.netlib.org/cephes">http://www.netlib.org/cephes</a>.</p>
</dd>
<dt class="label" id="amos-1986"><span class="brackets"><a class="fn-backref" href="#id3">Amos-1986</a></span></dt>
<dd><p>Amos, D. E. (1986). Algorithm 644: A portable package for Bessel functions of a complex argument and nonnegative order. ACM Trans. Math. Softw. 12, 3 (Sept. 1986), 265-273. DOI: <a class="reference external" href="https://doi.org/10.1145/7921.214331">https://doi.org/10.1145/7921.214331</a>. Available at <a class="reference external" href="http://netlib.org/amos/">http://netlib.org/amos/</a>.</p>
</dd>
<dt class="label" id="dlmf"><span class="brackets">DLMF</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id6">2</a>,<a href="#id8">3</a>,<a href="#id10">4</a>,<a href="#id12">5</a>)</span></dt>
<dd><p>Olver, F. W. J., Olde Daalhuis, A. B., Lozier, D. W., Schneider, B. I., Boisvert, R. F., Clark, C. W., Miller, B. R., Saunders, B. V., Cohl, H. S., and McClain, M. A., eds. NIST Digital Library of Mathematical Functions. <a class="reference external" href="http://dlmf.nist.gov/">http://dlmf.nist.gov/</a>, Release 1.1.0 of 2020-12-15.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="besseli.html" class="btn btn-neutral float-right" title="Modified Bessel Function of the First Kind" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="bessely.html" class="btn btn-neutral float-left" title="Bessel Function of the Second Kind" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Siavash Ameli.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>